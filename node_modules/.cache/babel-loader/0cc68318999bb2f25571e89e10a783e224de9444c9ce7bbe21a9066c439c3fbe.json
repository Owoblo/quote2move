{"ast":null,"code":"import _objectSpread from\"/Users/admin/random/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate,useLocation}from'react-router-dom';import{calculateEstimate}from'../lib/estimate';import{GoogleMapsService}from'../lib/googleMapsService';import{EmailService}from'../lib/emailService';import{PDFService}from'../lib/pdfService';import{QuoteService}from'../lib/quoteService';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function EstimatePage(){const navigate=useNavigate();const location=useLocation();const state=location.state;const[customerInfo,setCustomerInfo]=useState({name:'',email:'',phone:'',moveDate:''});const[originAddress,setOriginAddress]=useState((state===null||state===void 0?void 0:state.address)||'');const[destinationAddress,setDestinationAddress]=useState('');const[detections]=useState((state===null||state===void 0?void 0:state.detections)||[]);const[mapping]=useState((state===null||state===void 0?void 0:state.mapping)||{});const[baseEstimate]=useState((state===null||state===void 0?void 0:state.estimate)||{crew:3,rate:75,travelMins:30,stairs:false,elevator:false,wrapping:false,safetyPct:10,hours:0,total:0});// Generate upsells based on detected items - auto-select items that need special care\nconst[upsells,setUpsells]=useState(()=>{var _state$estimate;const initialUpsells=[{id:'insurance',name:'Moving Insurance',description:'Protect your belongings during the move',price:((state===null||state===void 0?void 0:(_state$estimate=state.estimate)===null||_state$estimate===void 0?void 0:_state$estimate.total)||0)*0.05,// 5% of total\nrecommended:true,selected:false},{id:'packing',name:'Packing Service',description:'Professional packing of your items',price:detections.reduce((sum,d)=>sum+d.qty*25,0),// $25 per item\nrecommended:detections.length>10,selected:false},{id:'unpacking',name:'Unpacking Service',description:'We unpack and organize at your new location',price:detections.reduce((sum,d)=>sum+d.qty*15,0),// $15 per item\nrecommended:false,selected:false}];// Detect TVs - AUTO-SELECT TV boxes (they NEED special boxes)\nconst tvDetections=detections.filter(d=>d.label.toLowerCase().includes('tv')||d.label.toLowerCase().includes('television')||d.label.toLowerCase().includes('flat screen'));const tvCount=tvDetections.reduce((sum,d)=>sum+d.qty,0);if(tvCount>0){initialUpsells.push({id:'tv-boxes',name:\"TV Boxes (\".concat(tvCount,\" TV\").concat(tvCount>1?'s':'',\")\"),description:'Specialty boxes and protective wrapping - Required for safe transport',price:tvCount*35,recommended:true,selected:true// AUTO-SELECTED - TVs need boxes!\n});}// Detect fragile items (arts, pictures, mirrors) - AUTO-SELECT fragile packing\nconst fragileItems=detections.filter(d=>{const label=d.label.toLowerCase();return label.includes('mirror')||label.includes('glass')||label.includes('art')||label.includes('artwork')||label.includes('picture')||label.includes('painting')||label.includes('frame')||label.includes('lamp')||label.includes('vase')||label.includes('chandelier')||label.includes('crystal');});if(fragileItems.length>0){const fragileQty=fragileItems.reduce((sum,d)=>sum+d.qty,0);initialUpsells.push({id:'fragile-packing',name:'Fragile Item Packing',description:\"Specialized bubble wrap & packing for \".concat(fragileQty,\" delicate item\").concat(fragileQty>1?'s':''),price:fragileItems.reduce((sum,d)=>sum+d.qty*20,0),recommended:true,selected:true// AUTO-SELECTED - fragile items need protection!\n});}// Detect specialty/heavy items that need special handling - AUTO-SELECT special handling\nconst specialtyItems=detections.filter(d=>{const label=d.label.toLowerCase();return label.includes('piano')||label.includes('grand piano')||label.includes('upright piano')||label.includes('treadmill')||label.includes('exercise equipment')||label.includes('pool table')||label.includes('billiard')||label.includes('safe')||label.includes('gun safe')||label.includes('aquarium')||label.includes('fish tank')||label.includes('grandfather clock')||label.includes('antique')||label.includes('statue');});if(specialtyItems.length>0){const specialtyQty=specialtyItems.reduce((sum,d)=>sum+d.qty,0);initialUpsells.push({id:'specialty-handling',name:'Specialty Item Handling',description:\"Professional disassembly, wrapping & handling for \".concat(specialtyQty,\" specialty item\").concat(specialtyQty>1?'s':'',\" (piano, treadmill, etc.)\"),price:specialtyItems.reduce((sum,d)=>{// Higher price for complex items\nconst isPiano=d.label.toLowerCase().includes('piano');const isTreadmill=d.label.toLowerCase().includes('treadmill');const isPoolTable=d.label.toLowerCase().includes('pool')||d.label.toLowerCase().includes('billiard');if(isPiano)return sum+d.qty*150;// Pianos are complex\nif(isTreadmill)return sum+d.qty*75;if(isPoolTable)return sum+d.qty*100;return sum+d.qty*60;// Other specialty items\n},0),recommended:true,selected:true// AUTO-SELECTED - these items need special handling!\n});}// Detect large appliances that might need special care\nconst largeAppliances=detections.filter(d=>{const label=d.label.toLowerCase();return label.includes('refrigerator')||label.includes('fridge')||label.includes('freezer')||label.includes('wine cooler')||label.includes('dishwasher');});if(largeAppliances.length>0){const applianceQty=largeAppliances.reduce((sum,d)=>sum+d.qty,0);initialUpsells.push({id:'appliance-protection',name:'Appliance Protection',description:\"Protective wrapping for \".concat(applianceQty,\" large appliance\").concat(applianceQty>1?'s':''),price:largeAppliances.reduce((sum,d)=>sum+d.qty*30,0),recommended:largeAppliances.length>1,selected:largeAppliances.length>1// Auto-select if multiple appliances\n});}return initialUpsells;});const[travelDistance,setTravelDistance]=useState(0);const[travelTime,setTravelTime]=useState(0);const[isCalculatingDistance,setIsCalculatingDistance]=useState(false);const[distanceError,setDistanceError]=useState(null);const[finalEstimate,setFinalEstimate]=useState(_objectSpread({},baseEstimate));const[isSendingQuote,setIsSendingQuote]=useState(false);const[showEmailOptions,setShowEmailOptions]=useState(false);// Auto-calculate distance when both addresses are provided\nuseEffect(()=>{const calculateDistance=async()=>{if(!originAddress||!destinationAddress||destinationAddress.length<10){return;// Wait for complete addresses\n}setIsCalculatingDistance(true);setDistanceError(null);try{const distanceResult=await GoogleMapsService.getDistance(originAddress,destinationAddress);setTravelDistance(Math.round(distanceResult.distance));setTravelTime(distanceResult.duration);// Update estimate with actual travel time\nconst updatedEstimate=_objectSpread(_objectSpread({},baseEstimate),{},{travelMins:distanceResult.duration});const result=calculateEstimate(detections,mapping,updatedEstimate);setFinalEstimate(_objectSpread(_objectSpread({},updatedEstimate),{},{hours:result.hours,total:result.total}));}catch(error){console.error('Distance calculation error:',error);setDistanceError(error.message||'Could not calculate distance');// Fallback to manual entry\n}finally{setIsCalculatingDistance(false);}};// Debounce to avoid too many API calls\nconst timer=setTimeout(()=>{calculateDistance();},1000);return()=>clearTimeout(timer);},[originAddress,destinationAddress,detections,mapping,baseEstimate]);// Update estimate when manually entering distance\nuseEffect(()=>{if(travelDistance>0&&!isCalculatingDistance){// Estimate: 30 minutes per 10 miles average\nconst estimatedMins=Math.ceil(travelDistance/10*30);const updatedEstimate=_objectSpread(_objectSpread({},baseEstimate),{},{travelMins:estimatedMins});const result=calculateEstimate(detections,mapping,updatedEstimate);setFinalEstimate(_objectSpread(_objectSpread({},updatedEstimate),{},{hours:result.hours,total:result.total}));}},[travelDistance,detections,mapping,baseEstimate,isCalculatingDistance]);// Calculate final total with upsells\nconst totalUpsells=upsells.filter(u=>u.selected).reduce((sum,u)=>sum+u.price,0);const finalTotal=finalEstimate.total+totalUpsells;const handleUpsellToggle=id=>{setUpsells(prev=>prev.map(u=>u.id===id?_objectSpread(_objectSpread({},u),{},{selected:!u.selected}):u));};const handleContinue=()=>{// Navigate to final quote/confirmation page or save quote\nnavigate('/dashboard');};const handleSendQuote=async()=>{if(!customerInfo.name||!customerInfo.email||!customerInfo.phone||!customerInfo.moveDate){alert('Please fill in all customer information fields');return;}if(!destinationAddress){alert('Please enter destination address');return;}setIsSendingQuote(true);try{// Create quote in database\nconst quoteData=await QuoteService.createQuote({customerName:customerInfo.name,customerEmail:customerInfo.email,customerPhone:customerInfo.phone,moveDate:customerInfo.moveDate,originAddress,destinationAddress,detections,estimate:finalEstimate,upsells:upsells.filter(u=>u.selected),totalAmount:finalTotal,photos:[]// You can add photos here if needed\n});// Generate quote URL\nconst quoteUrl=\"\".concat(window.location.origin,\"/quote/\").concat(quoteData.id);// Send email\nawait EmailService.sendQuote({customerName:customerInfo.name,customerEmail:customerInfo.email,customerPhone:customerInfo.phone,moveDate:customerInfo.moveDate,originAddress,destinationAddress,totalAmount:finalTotal,quoteId:quoteData.id,quoteUrl});alert('Quote sent successfully! Check your email for the quote link.');navigate('/dashboard');}catch(error){console.error('Error sending quote:',error);// Fallback: Show email options modal\nsetShowEmailOptions(true);}finally{setIsSendingQuote(false);}};const handleDownloadPDF=async()=>{try{const quoteData={id:'temp-'+Date.now(),customerName:customerInfo.name,customerEmail:customerInfo.email,customerPhone:customerInfo.phone,moveDate:customerInfo.moveDate,originAddress,destinationAddress,detections,estimate:finalEstimate,upsells:upsells.filter(u=>u.selected),totalAmount:finalTotal,photos:[]};await PDFService.downloadQuote(quoteData);}catch(error){console.error('Error generating PDF:',error);alert('Failed to generate PDF. Please try again.');}};// Group detections by room\nconst groupedDetections=detections.reduce((groups,detection)=>{const room=detection.room||'Unknown Room';if(!groups[room]){groups[room]=[];}groups[room].push(detection);return groups;},{});const totalItems=detections.reduce((sum,d)=>sum+d.qty,0);const totalCubicFeet=detections.reduce((sum,detection)=>{const mappingItem=mapping[detection.label];return sum+(mappingItem?mappingItem.cf*detection.qty:0);},0);return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"bg-white border-b border-gray-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between h-16\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/dashboard'),className:\"text-gray-600 hover:text-gray-900\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15 19l-7-7 7-7\"})})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-semibold text-gray-900\",children:\"Complete Your Quote\"})]})})})}),/*#__PURE__*/_jsx(\"main\",{className:\"max-w-7xl mx-auto px-6 py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-gray-100 p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"\\uD83D\\uDC64 Customer Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Full Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:customerInfo.name,onChange:e=>setCustomerInfo(prev=>_objectSpread(_objectSpread({},prev),{},{name:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\",placeholder:\"John Doe\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Email Address *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:customerInfo.email,onChange:e=>setCustomerInfo(prev=>_objectSpread(_objectSpread({},prev),{},{email:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\",placeholder:\"john@example.com\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Phone Number *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:customerInfo.phone,onChange:e=>setCustomerInfo(prev=>_objectSpread(_objectSpread({},prev),{},{phone:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\",placeholder:\"(555) 123-4567\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Move Date *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:customerInfo.moveDate,onChange:e=>setCustomerInfo(prev=>_objectSpread(_objectSpread({},prev),{},{moveDate:e.target.value})),className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\",min:new Date().toISOString().split('T')[0],required:true})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-gray-100 p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"\\uD83D\\uDCCD Origin & Destination\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Origin Address\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:originAddress,onChange:e=>setOriginAddress(e.target.value),className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\",placeholder:\"123 Main St, City, State\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Destination Address *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:destinationAddress,onChange:e=>setDestinationAddress(e.target.value),className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\",placeholder:\"456 Oak Ave, City, State\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[\"Distance (miles)\",isCalculatingDistance&&/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-xs text-blue-600 flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600 mr-1\"}),\"Calculating...\"]})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",value:travelDistance,onChange:e=>setTravelDistance(parseInt(e.target.value)||0),className:\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\",placeholder:\"Auto-calculated or enter manually\",disabled:isCalculatingDistance}),distanceError&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-red-600 mt-1\",children:distanceError}),travelTime>0&&!isCalculatingDistance&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-600 mt-1\",children:[\"\\u23F1\\uFE0F Estimated travel time: \",travelTime,\" minutes\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-gray-100 p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"\\uD83D\\uDCE6 Detected Inventory\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[Object.keys(groupedDetections).map(roomName=>/*#__PURE__*/_jsxs(\"div\",{className:\"border-l-4 border-blue-500 pl-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-medium text-gray-900 mb-2\",children:[\"\\uD83C\\uDFE0 \",roomName]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:groupedDetections[roomName].map((detection,idx)=>{const mappingItem=mapping[detection.label];return/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[detection.qty,\"x \",detection.label,detection.size&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-400 ml-2\",children:[\"(\",detection.size,\")\"]})]}),mappingItem&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",children:[mappingItem.cf*detection.qty,\" cf\"]})]},idx);})})]},roomName)),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-4 border-t border-gray-200 mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Total Items:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-900\",children:totalItems})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm mt-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Total Cubic Feet:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-900\",children:[totalCubicFeet.toFixed(2),\" cf\"]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-gray-100 p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"\\u2728 Additional Services\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:upsells.map(upsell=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-start p-4 border-2 rounded-xl cursor-pointer transition-colors \".concat(upsell.selected?'border-green-500 bg-green-50':upsell.recommended?'border-yellow-300 bg-yellow-50':'border-gray-200 hover:border-gray-300'),children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:upsell.selected,onChange:()=>handleUpsellToggle(upsell.id),className:\"mt-1 w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-3 flex-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:upsell.name}),upsell.selected&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-green-200 text-green-800 px-2 py-0.5 rounded-full font-medium\",children:\"\\u2713 Auto-Selected\"}),upsell.recommended&&!upsell.selected&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-yellow-200 text-yellow-800 px-2 py-0.5 rounded-full\",children:\"Recommended\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:upsell.description})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold text-gray-900 ml-4\",children:[\"$\",upsell.price.toFixed(2)]})]})})]},upsell.id))})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 sticky top-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"\\uD83D\\uDCB0 Quote Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm text-gray-600 mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Base Moving Cost:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",finalEstimate.total.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm text-gray-600 mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Estimated Time:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[finalEstimate.hours.toFixed(1),\" hours\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm text-gray-600 mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Crew Size:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[finalEstimate.crew,\" people\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm text-gray-600\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Travel Time:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[finalEstimate.travelMins,\" min\"]})]})]}),totalUpsells>0&&/*#__PURE__*/_jsx(\"div\",{className:\"pt-4 border-t border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm text-gray-600 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Additional Services:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",totalUpsells.toFixed(2)]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"pt-4 border-t-2 border-gray-300\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-semibold text-gray-900\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-2xl font-bold text-blue-600\",children:[\"$\",finalTotal.toFixed(2)]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 space-y-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSendQuote,disabled:!destinationAddress||!customerInfo.name||!customerInfo.email||!customerInfo.phone||!customerInfo.moveDate||isSendingQuote,className:\"w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-semibold py-3 px-4 rounded-xl transition-colors disabled:cursor-not-allowed flex items-center justify-center space-x-2\",children:isSendingQuote?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Sending Quote...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Send Quote via Email\"})]})}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleDownloadPDF,disabled:!destinationAddress||!customerInfo.name||!customerInfo.email||!customerInfo.phone||!customerInfo.moveDate,className:\"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold py-3 px-4 rounded-xl transition-colors disabled:cursor-not-allowed flex items-center justify-center space-x-2\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Download PDF Quote\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleContinue,disabled:!destinationAddress||!customerInfo.name||!customerInfo.email||!customerInfo.phone||!customerInfo.moveDate,className:\"w-full bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white font-semibold py-3 px-4 rounded-xl transition-colors disabled:cursor-not-allowed\",children:\"Save & Continue Later\"})]})]})]})})]})}),showEmailOptions&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-md\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Email Setup Required\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"To send quotes via email, you need to set up EmailJS. For now, you can:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const mailtoLink=EmailService.generateMailtoLink({customerName:customerInfo.name,customerEmail:customerInfo.email,customerPhone:customerInfo.phone,moveDate:customerInfo.moveDate,originAddress,destinationAddress,totalAmount:finalTotal,quoteId:'temp-id',quoteUrl:\"\".concat(window.location.origin,\"/quote/temp-id\")});window.open(mailtoLink);},className:\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg\",children:\"Open Email Client\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDownloadPDF,className:\"w-full bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-4 rounded-lg\",children:\"Download PDF Instead\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowEmailOptions(false),className:\"w-full bg-gray-300 hover:bg-gray-400 text-gray-700 font-semibold py-3 px-4 rounded-lg\",children:\"Cancel\"})]})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useLocation","calculateEstimate","GoogleMapsService","EmailService","PDFService","QuoteService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","EstimatePage","navigate","location","state","customerInfo","setCustomerInfo","name","email","phone","moveDate","originAddress","setOriginAddress","address","destinationAddress","setDestinationAddress","detections","mapping","baseEstimate","estimate","crew","rate","travelMins","stairs","elevator","wrapping","safetyPct","hours","total","upsells","setUpsells","_state$estimate","initialUpsells","id","description","price","recommended","selected","reduce","sum","d","qty","length","tvDetections","filter","label","toLowerCase","includes","tvCount","push","concat","fragileItems","fragileQty","specialtyItems","specialtyQty","isPiano","isTreadmill","isPoolTable","largeAppliances","applianceQty","travelDistance","setTravelDistance","travelTime","setTravelTime","isCalculatingDistance","setIsCalculatingDistance","distanceError","setDistanceError","finalEstimate","setFinalEstimate","_objectSpread","isSendingQuote","setIsSendingQuote","showEmailOptions","setShowEmailOptions","calculateDistance","distanceResult","getDistance","Math","round","distance","duration","updatedEstimate","result","error","console","message","timer","setTimeout","clearTimeout","estimatedMins","ceil","totalUpsells","u","finalTotal","handleUpsellToggle","prev","map","handleContinue","handleSendQuote","alert","quoteData","createQuote","customerName","customerEmail","customerPhone","totalAmount","photos","quoteUrl","window","origin","sendQuote","quoteId","handleDownloadPDF","Date","now","downloadQuote","groupedDetections","groups","detection","room","totalItems","totalCubicFeet","mappingItem","cf","className","children","onClick","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","type","value","onChange","e","target","placeholder","required","min","toISOString","split","parseInt","disabled","Object","keys","roomName","idx","size","toFixed","upsell","checked","mailtoLink","generateMailtoLink","open"],"sources":["/Users/admin/random/src/pages/EstimatePage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { Detection, MappingTable, Estimate } from '../types';\nimport { calculateEstimate } from '../lib/estimate';\nimport { GoogleMapsService } from '../lib/googleMapsService';\nimport { EmailService } from '../lib/emailService';\nimport { PDFService } from '../lib/pdfService';\nimport { QuoteService } from '../lib/quoteService';\n\ninterface LocationState {\n  address: string;\n  detections: Detection[];\n  estimate: Estimate;\n  mapping: MappingTable;\n}\n\ninterface Upsell {\n  id: string;\n  name: string;\n  description: string;\n  price: number;\n  recommended: boolean;\n  selected: boolean;\n}\n\nexport default function EstimatePage() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const state = location.state as LocationState;\n\n  const [customerInfo, setCustomerInfo] = useState({\n    name: '',\n    email: '',\n    phone: '',\n    moveDate: ''\n  });\n\n  const [originAddress, setOriginAddress] = useState(state?.address || '');\n  const [destinationAddress, setDestinationAddress] = useState('');\n  const [detections] = useState<Detection[]>(state?.detections || []);\n  const [mapping] = useState<MappingTable>(state?.mapping || {});\n  const [baseEstimate] = useState<Estimate>(state?.estimate || {\n    crew: 3,\n    rate: 75,\n    travelMins: 30,\n    stairs: false,\n    elevator: false,\n    wrapping: false,\n    safetyPct: 10,\n    hours: 0,\n    total: 0\n  });\n\n  // Generate upsells based on detected items - auto-select items that need special care\n  const [upsells, setUpsells] = useState<Upsell[]>(() => {\n    const initialUpsells: Upsell[] = [\n      {\n        id: 'insurance',\n        name: 'Moving Insurance',\n        description: 'Protect your belongings during the move',\n        price: (state?.estimate?.total || 0) * 0.05, // 5% of total\n        recommended: true,\n        selected: false\n      },\n      {\n        id: 'packing',\n        name: 'Packing Service',\n        description: 'Professional packing of your items',\n        price: detections.reduce((sum, d) => sum + (d.qty * 25), 0), // $25 per item\n        recommended: detections.length > 10,\n        selected: false\n      },\n      {\n        id: 'unpacking',\n        name: 'Unpacking Service',\n        description: 'We unpack and organize at your new location',\n        price: detections.reduce((sum, d) => sum + (d.qty * 15), 0), // $15 per item\n        recommended: false,\n        selected: false\n      }\n    ];\n\n    // Detect TVs - AUTO-SELECT TV boxes (they NEED special boxes)\n    const tvDetections = detections.filter(d => \n      d.label.toLowerCase().includes('tv') || \n      d.label.toLowerCase().includes('television') ||\n      d.label.toLowerCase().includes('flat screen')\n    );\n    const tvCount = tvDetections.reduce((sum, d) => sum + d.qty, 0);\n\n    if (tvCount > 0) {\n      initialUpsells.push({\n        id: 'tv-boxes',\n        name: `TV Boxes (${tvCount} TV${tvCount > 1 ? 's' : ''})`,\n        description: 'Specialty boxes and protective wrapping - Required for safe transport',\n        price: tvCount * 35,\n        recommended: true,\n        selected: true // AUTO-SELECTED - TVs need boxes!\n      });\n    }\n\n    // Detect fragile items (arts, pictures, mirrors) - AUTO-SELECT fragile packing\n    const fragileItems = detections.filter(d => {\n      const label = d.label.toLowerCase();\n      return label.includes('mirror') ||\n        label.includes('glass') ||\n        label.includes('art') ||\n        label.includes('artwork') ||\n        label.includes('picture') ||\n        label.includes('painting') ||\n        label.includes('frame') ||\n        label.includes('lamp') ||\n        label.includes('vase') ||\n        label.includes('chandelier') ||\n        label.includes('crystal');\n    });\n\n    if (fragileItems.length > 0) {\n      const fragileQty = fragileItems.reduce((sum, d) => sum + d.qty, 0);\n      initialUpsells.push({\n        id: 'fragile-packing',\n        name: 'Fragile Item Packing',\n        description: `Specialized bubble wrap & packing for ${fragileQty} delicate item${fragileQty > 1 ? 's' : ''}`,\n        price: fragileItems.reduce((sum, d) => sum + (d.qty * 20), 0),\n        recommended: true,\n        selected: true // AUTO-SELECTED - fragile items need protection!\n      });\n    }\n\n    // Detect specialty/heavy items that need special handling - AUTO-SELECT special handling\n    const specialtyItems = detections.filter(d => {\n      const label = d.label.toLowerCase();\n      return label.includes('piano') ||\n        label.includes('grand piano') ||\n        label.includes('upright piano') ||\n        label.includes('treadmill') ||\n        label.includes('exercise equipment') ||\n        label.includes('pool table') ||\n        label.includes('billiard') ||\n        label.includes('safe') ||\n        label.includes('gun safe') ||\n        label.includes('aquarium') ||\n        label.includes('fish tank') ||\n        label.includes('grandfather clock') ||\n        label.includes('antique') ||\n        label.includes('statue');\n    });\n\n    if (specialtyItems.length > 0) {\n      const specialtyQty = specialtyItems.reduce((sum, d) => sum + d.qty, 0);\n      initialUpsells.push({\n        id: 'specialty-handling',\n        name: 'Specialty Item Handling',\n        description: `Professional disassembly, wrapping & handling for ${specialtyQty} specialty item${specialtyQty > 1 ? 's' : ''} (piano, treadmill, etc.)`,\n        price: specialtyItems.reduce((sum, d) => {\n          // Higher price for complex items\n          const isPiano = d.label.toLowerCase().includes('piano');\n          const isTreadmill = d.label.toLowerCase().includes('treadmill');\n          const isPoolTable = d.label.toLowerCase().includes('pool') || d.label.toLowerCase().includes('billiard');\n          \n          if (isPiano) return sum + (d.qty * 150); // Pianos are complex\n          if (isTreadmill) return sum + (d.qty * 75);\n          if (isPoolTable) return sum + (d.qty * 100);\n          return sum + (d.qty * 60); // Other specialty items\n        }, 0),\n        recommended: true,\n        selected: true // AUTO-SELECTED - these items need special handling!\n      });\n    }\n\n    // Detect large appliances that might need special care\n    const largeAppliances = detections.filter(d => {\n      const label = d.label.toLowerCase();\n      return label.includes('refrigerator') ||\n        label.includes('fridge') ||\n        label.includes('freezer') ||\n        label.includes('wine cooler') ||\n        label.includes('dishwasher');\n    });\n\n    if (largeAppliances.length > 0) {\n      const applianceQty = largeAppliances.reduce((sum, d) => sum + d.qty, 0);\n      initialUpsells.push({\n        id: 'appliance-protection',\n        name: 'Appliance Protection',\n        description: `Protective wrapping for ${applianceQty} large appliance${applianceQty > 1 ? 's' : ''}`,\n        price: largeAppliances.reduce((sum, d) => sum + (d.qty * 30), 0),\n        recommended: largeAppliances.length > 1,\n        selected: largeAppliances.length > 1 // Auto-select if multiple appliances\n      });\n    }\n\n    return initialUpsells;\n  });\n\n  const [travelDistance, setTravelDistance] = useState(0);\n  const [travelTime, setTravelTime] = useState(0);\n  const [isCalculatingDistance, setIsCalculatingDistance] = useState(false);\n  const [distanceError, setDistanceError] = useState<string | null>(null);\n  const [finalEstimate, setFinalEstimate] = useState<Estimate>({ ...baseEstimate });\n  const [isSendingQuote, setIsSendingQuote] = useState(false);\n  const [showEmailOptions, setShowEmailOptions] = useState(false);\n\n  // Auto-calculate distance when both addresses are provided\n  useEffect(() => {\n    const calculateDistance = async () => {\n      if (!originAddress || !destinationAddress || destinationAddress.length < 10) {\n        return; // Wait for complete addresses\n      }\n\n      setIsCalculatingDistance(true);\n      setDistanceError(null);\n\n      try {\n        const distanceResult = await GoogleMapsService.getDistance(\n          originAddress,\n          destinationAddress\n        );\n        \n        setTravelDistance(Math.round(distanceResult.distance));\n        setTravelTime(distanceResult.duration);\n        \n        // Update estimate with actual travel time\n        const updatedEstimate = {\n          ...baseEstimate,\n          travelMins: distanceResult.duration\n        };\n\n        const result = calculateEstimate(detections, mapping, updatedEstimate);\n        setFinalEstimate({\n          ...updatedEstimate,\n          hours: result.hours,\n          total: result.total\n        });\n      } catch (error: any) {\n        console.error('Distance calculation error:', error);\n        setDistanceError(error.message || 'Could not calculate distance');\n        // Fallback to manual entry\n      } finally {\n        setIsCalculatingDistance(false);\n      }\n    };\n\n    // Debounce to avoid too many API calls\n    const timer = setTimeout(() => {\n      calculateDistance();\n    }, 1000);\n\n    return () => clearTimeout(timer);\n  }, [originAddress, destinationAddress, detections, mapping, baseEstimate]);\n\n  // Update estimate when manually entering distance\n  useEffect(() => {\n    if (travelDistance > 0 && !isCalculatingDistance) {\n      // Estimate: 30 minutes per 10 miles average\n      const estimatedMins = Math.ceil((travelDistance / 10) * 30);\n      \n      const updatedEstimate = {\n        ...baseEstimate,\n        travelMins: estimatedMins\n      };\n\n      const result = calculateEstimate(detections, mapping, updatedEstimate);\n      setFinalEstimate({\n        ...updatedEstimate,\n        hours: result.hours,\n        total: result.total\n      });\n    }\n  }, [travelDistance, detections, mapping, baseEstimate, isCalculatingDistance]);\n\n  // Calculate final total with upsells\n  const totalUpsells = upsells.filter(u => u.selected).reduce((sum, u) => sum + u.price, 0);\n  const finalTotal = finalEstimate.total + totalUpsells;\n\n  const handleUpsellToggle = (id: string) => {\n    setUpsells(prev => \n      prev.map(u => u.id === id ? { ...u, selected: !u.selected } : u)\n    );\n  };\n\n  const handleContinue = () => {\n    // Navigate to final quote/confirmation page or save quote\n    navigate('/dashboard');\n  };\n\n  const handleSendQuote = async () => {\n    if (!customerInfo.name || !customerInfo.email || !customerInfo.phone || !customerInfo.moveDate) {\n      alert('Please fill in all customer information fields');\n      return;\n    }\n\n    if (!destinationAddress) {\n      alert('Please enter destination address');\n      return;\n    }\n\n    setIsSendingQuote(true);\n    try {\n      // Create quote in database\n      const quoteData = await QuoteService.createQuote({\n        customerName: customerInfo.name,\n        customerEmail: customerInfo.email,\n        customerPhone: customerInfo.phone,\n        moveDate: customerInfo.moveDate,\n        originAddress,\n        destinationAddress,\n        detections,\n        estimate: finalEstimate,\n        upsells: upsells.filter(u => u.selected),\n        totalAmount: finalTotal,\n        photos: [] // You can add photos here if needed\n      });\n\n      // Generate quote URL\n      const quoteUrl = `${window.location.origin}/quote/${quoteData.id}`;\n\n      // Send email\n      await EmailService.sendQuote({\n        customerName: customerInfo.name,\n        customerEmail: customerInfo.email,\n        customerPhone: customerInfo.phone,\n        moveDate: customerInfo.moveDate,\n        originAddress,\n        destinationAddress,\n        totalAmount: finalTotal,\n        quoteId: quoteData.id!,\n        quoteUrl\n      });\n\n      alert('Quote sent successfully! Check your email for the quote link.');\n      navigate('/dashboard');\n    } catch (error: any) {\n      console.error('Error sending quote:', error);\n      \n      // Fallback: Show email options modal\n      setShowEmailOptions(true);\n    } finally {\n      setIsSendingQuote(false);\n    }\n  };\n\n  const handleDownloadPDF = async () => {\n    try {\n      const quoteData = {\n        id: 'temp-' + Date.now(),\n        customerName: customerInfo.name,\n        customerEmail: customerInfo.email,\n        customerPhone: customerInfo.phone,\n        moveDate: customerInfo.moveDate,\n        originAddress,\n        destinationAddress,\n        detections,\n        estimate: finalEstimate,\n        upsells: upsells.filter(u => u.selected),\n        totalAmount: finalTotal,\n        photos: []\n      };\n\n      await PDFService.downloadQuote(quoteData);\n    } catch (error) {\n      console.error('Error generating PDF:', error);\n      alert('Failed to generate PDF. Please try again.');\n    }\n  };\n\n  // Group detections by room\n  const groupedDetections = detections.reduce((groups, detection) => {\n    const room = detection.room || 'Unknown Room';\n    if (!groups[room]) {\n      groups[room] = [];\n    }\n    groups[room].push(detection);\n    return groups;\n  }, {} as Record<string, Detection[]>);\n\n  const totalItems = detections.reduce((sum, d) => sum + d.qty, 0);\n  const totalCubicFeet = detections.reduce((sum, detection) => {\n    const mappingItem = mapping[detection.label];\n    return sum + (mappingItem ? mappingItem.cf * detection.qty : 0);\n  }, 0);\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <header className=\"bg-white border-b border-gray-100\">\n        <div className=\"max-w-7xl mx-auto px-6\">\n          <div className=\"flex items-center justify-between h-16\">\n            <div className=\"flex items-center space-x-3\">\n              <button\n                onClick={() => navigate('/dashboard')}\n                className=\"text-gray-600 hover:text-gray-900\"\n              >\n                <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n                </svg>\n              </button>\n              <h1 className=\"text-xl font-semibold text-gray-900\">Complete Your Quote</h1>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-6 py-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Left Column: Form */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            {/* Customer Information */}\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 p-6\">\n              <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">üë§ Customer Information</h2>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Full Name *\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={customerInfo.name}\n                    onChange={(e) => setCustomerInfo(prev => ({ ...prev, name: e.target.value }))}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"John Doe\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Email Address *\n                  </label>\n                  <input\n                    type=\"email\"\n                    value={customerInfo.email}\n                    onChange={(e) => setCustomerInfo(prev => ({ ...prev, email: e.target.value }))}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"john@example.com\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Phone Number *\n                  </label>\n                  <input\n                    type=\"tel\"\n                    value={customerInfo.phone}\n                    onChange={(e) => setCustomerInfo(prev => ({ ...prev, phone: e.target.value }))}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"(555) 123-4567\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Move Date *\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={customerInfo.moveDate}\n                    onChange={(e) => setCustomerInfo(prev => ({ ...prev, moveDate: e.target.value }))}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    min={new Date().toISOString().split('T')[0]}\n                    required\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Origin & Destination */}\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 p-6\">\n              <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">üìç Origin & Destination</h2>\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Origin Address\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={originAddress}\n                    onChange={(e) => setOriginAddress(e.target.value)}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"123 Main St, City, State\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Destination Address *\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={destinationAddress}\n                    onChange={(e) => setDestinationAddress(e.target.value)}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"456 Oak Ave, City, State\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Distance (miles)\n                    {isCalculatingDistance && (\n                      <span className=\"ml-2 text-xs text-blue-600 flex items-center\">\n                        <div className=\"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600 mr-1\"></div>\n                        Calculating...\n                      </span>\n                    )}\n                  </label>\n                  <input\n                    type=\"number\"\n                    min=\"0\"\n                    value={travelDistance}\n                    onChange={(e) => setTravelDistance(parseInt(e.target.value) || 0)}\n                    className=\"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"Auto-calculated or enter manually\"\n                    disabled={isCalculatingDistance}\n                  />\n                  {distanceError && (\n                    <p className=\"text-xs text-red-600 mt-1\">{distanceError}</p>\n                  )}\n                  {travelTime > 0 && !isCalculatingDistance && (\n                    <p className=\"text-xs text-gray-600 mt-1\">\n                      ‚è±Ô∏è Estimated travel time: {travelTime} minutes\n                    </p>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            {/* Inventory Summary */}\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 p-6\">\n              <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">üì¶ Detected Inventory</h2>\n              <div className=\"space-y-4\">\n                {Object.keys(groupedDetections).map(roomName => (\n                  <div key={roomName} className=\"border-l-4 border-blue-500 pl-4\">\n                    <h3 className=\"font-medium text-gray-900 mb-2\">üè† {roomName}</h3>\n                    <div className=\"space-y-2\">\n                      {groupedDetections[roomName].map((detection, idx) => {\n                        const mappingItem = mapping[detection.label];\n                        return (\n                          <div key={idx} className=\"text-sm text-gray-600 flex items-center justify-between\">\n                            <span>\n                              {detection.qty}x {detection.label}\n                              {detection.size && <span className=\"text-gray-400 ml-2\">({detection.size})</span>}\n                            </span>\n                            {mappingItem && (\n                              <span className=\"text-gray-500\">\n                                {mappingItem.cf * detection.qty} cf\n                              </span>\n                            )}\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                ))}\n                <div className=\"pt-4 border-t border-gray-200 mt-4\">\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"font-medium text-gray-700\">Total Items:</span>\n                    <span className=\"text-gray-900\">{totalItems}</span>\n                  </div>\n                  <div className=\"flex justify-between text-sm mt-1\">\n                    <span className=\"font-medium text-gray-700\">Total Cubic Feet:</span>\n                    <span className=\"text-gray-900\">{totalCubicFeet.toFixed(2)} cf</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Additional Services / Upsells */}\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 p-6\">\n              <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">‚ú® Additional Services</h2>\n              <div className=\"space-y-3\">\n                {upsells.map((upsell) => (\n                  <label\n                    key={upsell.id}\n                    className={`flex items-start p-4 border-2 rounded-xl cursor-pointer transition-colors ${\n                      upsell.selected\n                        ? 'border-green-500 bg-green-50'\n                        : upsell.recommended\n                        ? 'border-yellow-300 bg-yellow-50'\n                        : 'border-gray-200 hover:border-gray-300'\n                    }`}\n                  >\n                    <input\n                      type=\"checkbox\"\n                      checked={upsell.selected}\n                      onChange={() => handleUpsellToggle(upsell.id)}\n                      className=\"mt-1 w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\n                    />\n                    <div className=\"ml-3 flex-1\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <div className=\"flex items-center space-x-2\">\n                            <span className=\"font-medium text-gray-900\">{upsell.name}</span>\n                            {upsell.selected && (\n                              <span className=\"text-xs bg-green-200 text-green-800 px-2 py-0.5 rounded-full font-medium\">\n                                ‚úì Auto-Selected\n                              </span>\n                            )}\n                            {upsell.recommended && !upsell.selected && (\n                              <span className=\"text-xs bg-yellow-200 text-yellow-800 px-2 py-0.5 rounded-full\">\n                                Recommended\n                              </span>\n                            )}\n                          </div>\n                          <p className=\"text-sm text-gray-600 mt-1\">{upsell.description}</p>\n                        </div>\n                        <span className=\"font-semibold text-gray-900 ml-4\">\n                          ${upsell.price.toFixed(2)}\n                        </span>\n                      </div>\n                    </div>\n                  </label>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          {/* Right Column: Quote Summary */}\n          <div className=\"lg:col-span-1\">\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 sticky top-8\">\n              <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">üí∞ Quote Summary</h2>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <div className=\"flex justify-between text-sm text-gray-600 mb-1\">\n                    <span>Base Moving Cost:</span>\n                    <span>${finalEstimate.total.toFixed(2)}</span>\n                  </div>\n                  <div className=\"flex justify-between text-sm text-gray-600 mb-1\">\n                    <span>Estimated Time:</span>\n                    <span>{finalEstimate.hours.toFixed(1)} hours</span>\n                  </div>\n                  <div className=\"flex justify-between text-sm text-gray-600 mb-1\">\n                    <span>Crew Size:</span>\n                    <span>{finalEstimate.crew} people</span>\n                  </div>\n                  <div className=\"flex justify-between text-sm text-gray-600\">\n                    <span>Travel Time:</span>\n                    <span>{finalEstimate.travelMins} min</span>\n                  </div>\n                </div>\n\n                {totalUpsells > 0 && (\n                  <div className=\"pt-4 border-t border-gray-200\">\n                    <div className=\"flex justify-between text-sm text-gray-600 mb-2\">\n                      <span>Additional Services:</span>\n                      <span>${totalUpsells.toFixed(2)}</span>\n                    </div>\n                  </div>\n                )}\n\n                <div className=\"pt-4 border-t-2 border-gray-300\">\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-lg font-semibold text-gray-900\">Total:</span>\n                    <span className=\"text-2xl font-bold text-blue-600\">\n                      ${finalTotal.toFixed(2)}\n                    </span>\n                  </div>\n                </div>\n\n                <div className=\"mt-6 space-y-3\">\n                  <button\n                    onClick={handleSendQuote}\n                    disabled={!destinationAddress || !customerInfo.name || !customerInfo.email || !customerInfo.phone || !customerInfo.moveDate || isSendingQuote}\n                    className=\"w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-semibold py-3 px-4 rounded-xl transition-colors disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\n                  >\n                    {isSendingQuote ? (\n                      <>\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n                        <span>Sending Quote...</span>\n                      </>\n                    ) : (\n                      <>\n                        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\n                        </svg>\n                        <span>Send Quote via Email</span>\n                      </>\n                    )}\n                  </button>\n                  \n                  <button\n                    onClick={handleDownloadPDF}\n                    disabled={!destinationAddress || !customerInfo.name || !customerInfo.email || !customerInfo.phone || !customerInfo.moveDate}\n                    className=\"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold py-3 px-4 rounded-xl transition-colors disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\n                  >\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                    </svg>\n                    <span>Download PDF Quote</span>\n                  </button>\n                  \n                  <button\n                    onClick={handleContinue}\n                    disabled={!destinationAddress || !customerInfo.name || !customerInfo.email || !customerInfo.phone || !customerInfo.moveDate}\n                    className=\"w-full bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white font-semibold py-3 px-4 rounded-xl transition-colors disabled:cursor-not-allowed\"\n                  >\n                    Save & Continue Later\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </main>\n\n      {/* Email Options Modal */}\n      {showEmailOptions && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n          <div className=\"bg-white rounded-xl p-6 w-full max-w-md\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Email Setup Required</h3>\n            <p className=\"text-gray-600 mb-4\">\n              To send quotes via email, you need to set up EmailJS. For now, you can:\n            </p>\n            <div className=\"space-y-3\">\n              <button\n                onClick={() => {\n                  const mailtoLink = EmailService.generateMailtoLink({\n                    customerName: customerInfo.name,\n                    customerEmail: customerInfo.email,\n                    customerPhone: customerInfo.phone,\n                    moveDate: customerInfo.moveDate,\n                    originAddress,\n                    destinationAddress,\n                    totalAmount: finalTotal,\n                    quoteId: 'temp-id',\n                    quoteUrl: `${window.location.origin}/quote/temp-id`\n                  });\n                  window.open(mailtoLink);\n                }}\n                className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg\"\n              >\n                Open Email Client\n              </button>\n              <button\n                onClick={handleDownloadPDF}\n                className=\"w-full bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-4 rounded-lg\"\n              >\n                Download PDF Instead\n              </button>\n              <button\n                onClick={() => setShowEmailOptions(false)}\n                className=\"w-full bg-gray-300 hover:bg-gray-400 text-gray-700 font-semibold py-3 px-4 rounded-lg\"\n              >\n                Cancel\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}