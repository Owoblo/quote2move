{"ast":null,"code":"import { supabase } from './supabase';\nexport class ProjectService {\n  // Save a project/quote\n  static async saveProject(address, detections, estimate, projectName, notes) {\n    const {\n      data: {\n        user\n      }\n    } = await supabase.auth.getUser();\n    if (!user) {\n      throw new Error('User must be logged in to save projects');\n    }\n    const projectData = {\n      user_id: user.id,\n      address,\n      detections,\n      estimate,\n      project_name: projectName || address || 'Untitled Project',\n      notes: notes || null,\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString()\n    };\n    const {\n      data,\n      error\n    } = await supabase.from('projects').insert([projectData]).select().single();\n    if (error) {\n      console.error('Error saving project:', error);\n      throw new Error(`Failed to save project: ${error.message}`);\n    }\n    return data;\n  }\n\n  // Get all projects for the current user\n  static async getUserProjects() {\n    const {\n      data: {\n        user\n      }\n    } = await supabase.auth.getUser();\n    if (!user) {\n      throw new Error('User must be logged in to view projects');\n    }\n    const {\n      data,\n      error\n    } = await supabase.from('projects').select('*').eq('user_id', user.id).order('updated_at', {\n      ascending: false\n    });\n    if (error) {\n      console.error('Error loading projects:', error);\n      throw new Error(`Failed to load projects: ${error.message}`);\n    }\n    return data || [];\n  }\n\n  // Get a single project by ID\n  static async getProject(projectId) {\n    const {\n      data: {\n        user\n      }\n    } = await supabase.auth.getUser();\n    if (!user) {\n      throw new Error('User must be logged in to view projects');\n    }\n    const {\n      data,\n      error\n    } = await supabase.from('projects').select('*').eq('id', projectId).eq('user_id', user.id).single();\n    if (error) {\n      console.error('Error loading project:', error);\n      throw new Error(`Failed to load project: ${error.message}`);\n    }\n    if (!data) {\n      throw new Error('Project not found');\n    }\n    return data;\n  }\n\n  // Update an existing project\n  static async updateProject(projectId, address, detections, estimate, projectName, notes) {\n    const {\n      data: {\n        user\n      }\n    } = await supabase.auth.getUser();\n    if (!user) {\n      throw new Error('User must be logged in to update projects');\n    }\n    const {\n      data,\n      error\n    } = await supabase.from('projects').update({\n      address,\n      detections,\n      estimate,\n      project_name: projectName || address || 'Untitled Project',\n      notes: notes || null,\n      updated_at: new Date().toISOString()\n    }).eq('id', projectId).eq('user_id', user.id).select().single();\n    if (error) {\n      console.error('Error updating project:', error);\n      throw new Error(`Failed to update project: ${error.message}`);\n    }\n    return data;\n  }\n\n  // Delete a project\n  static async deleteProject(projectId) {\n    const {\n      data: {\n        user\n      }\n    } = await supabase.auth.getUser();\n    if (!user) {\n      throw new Error('User must be logged in to delete projects');\n    }\n    const {\n      error\n    } = await supabase.from('projects').delete().eq('id', projectId).eq('user_id', user.id);\n    if (error) {\n      console.error('Error deleting project:', error);\n      throw new Error(`Failed to delete project: ${error.message}`);\n    }\n  }\n}","map":{"version":3,"names":["supabase","ProjectService","saveProject","address","detections","estimate","projectName","notes","data","user","auth","getUser","Error","projectData","user_id","id","project_name","created_at","Date","toISOString","updated_at","error","from","insert","select","single","console","message","getUserProjects","eq","order","ascending","getProject","projectId","updateProject","update","deleteProject","delete"],"sources":["/Users/admin/random/src/lib/projectService.ts"],"sourcesContent":["import { supabase } from './supabase';\nimport { QuotePayload, Detection } from '../types';\n\nexport interface Project {\n  id: string;\n  user_id: string;\n  address: string;\n  detections: Detection[];\n  estimate: QuotePayload['estimate'];\n  created_at: string;\n  updated_at: string;\n  notes?: string;\n  project_name?: string;\n}\n\nexport class ProjectService {\n  // Save a project/quote\n  static async saveProject(\n    address: string,\n    detections: Detection[],\n    estimate: QuotePayload['estimate'],\n    projectName?: string,\n    notes?: string\n  ): Promise<Project> {\n    const { data: { user } } = await supabase.auth.getUser();\n    \n    if (!user) {\n      throw new Error('User must be logged in to save projects');\n    }\n\n    const projectData = {\n      user_id: user.id,\n      address,\n      detections,\n      estimate,\n      project_name: projectName || address || 'Untitled Project',\n      notes: notes || null,\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString(),\n    };\n\n    const { data, error } = await supabase\n      .from('projects')\n      .insert([projectData])\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error saving project:', error);\n      throw new Error(`Failed to save project: ${error.message}`);\n    }\n\n    return data;\n  }\n\n  // Get all projects for the current user\n  static async getUserProjects(): Promise<Project[]> {\n    const { data: { user } } = await supabase.auth.getUser();\n    \n    if (!user) {\n      throw new Error('User must be logged in to view projects');\n    }\n\n    const { data, error } = await supabase\n      .from('projects')\n      .select('*')\n      .eq('user_id', user.id)\n      .order('updated_at', { ascending: false });\n\n    if (error) {\n      console.error('Error loading projects:', error);\n      throw new Error(`Failed to load projects: ${error.message}`);\n    }\n\n    return data || [];\n  }\n\n  // Get a single project by ID\n  static async getProject(projectId: string): Promise<Project> {\n    const { data: { user } } = await supabase.auth.getUser();\n    \n    if (!user) {\n      throw new Error('User must be logged in to view projects');\n    }\n\n    const { data, error } = await supabase\n      .from('projects')\n      .select('*')\n      .eq('id', projectId)\n      .eq('user_id', user.id)\n      .single();\n\n    if (error) {\n      console.error('Error loading project:', error);\n      throw new Error(`Failed to load project: ${error.message}`);\n    }\n\n    if (!data) {\n      throw new Error('Project not found');\n    }\n\n    return data;\n  }\n\n  // Update an existing project\n  static async updateProject(\n    projectId: string,\n    address: string,\n    detections: Detection[],\n    estimate: QuotePayload['estimate'],\n    projectName?: string,\n    notes?: string\n  ): Promise<Project> {\n    const { data: { user } } = await supabase.auth.getUser();\n    \n    if (!user) {\n      throw new Error('User must be logged in to update projects');\n    }\n\n    const { data, error } = await supabase\n      .from('projects')\n      .update({\n        address,\n        detections,\n        estimate,\n        project_name: projectName || address || 'Untitled Project',\n        notes: notes || null,\n        updated_at: new Date().toISOString(),\n      })\n      .eq('id', projectId)\n      .eq('user_id', user.id)\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error updating project:', error);\n      throw new Error(`Failed to update project: ${error.message}`);\n    }\n\n    return data;\n  }\n\n  // Delete a project\n  static async deleteProject(projectId: string): Promise<void> {\n    const { data: { user } } = await supabase.auth.getUser();\n    \n    if (!user) {\n      throw new Error('User must be logged in to delete projects');\n    }\n\n    const { error } = await supabase\n      .from('projects')\n      .delete()\n      .eq('id', projectId)\n      .eq('user_id', user.id);\n\n    if (error) {\n      console.error('Error deleting project:', error);\n      throw new Error(`Failed to delete project: ${error.message}`);\n    }\n  }\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}