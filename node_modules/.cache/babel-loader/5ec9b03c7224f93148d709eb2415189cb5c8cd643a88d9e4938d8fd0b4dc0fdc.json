{"ast":null,"code":"export function calculateEstimate(detections, mapping, params) {\n  let totalMinutes = 0;\n  let totalCubicFeet = 0;\n\n  // Calculate total time and cubic feet based on detections\n  detections.forEach(detection => {\n    const mappingItem = mapping[detection.label];\n    if (mappingItem) {\n      totalMinutes += mappingItem.minutes * detection.qty;\n      totalCubicFeet += mappingItem.cf * detection.qty;\n    }\n  });\n\n  // Add travel time\n  totalMinutes += params.travelMins;\n\n  // Apply stairs/elevator multipliers\n  if (params.stairs) {\n    totalMinutes *= 1.3; // 30% increase for stairs\n  }\n  if (params.elevator) {\n    totalMinutes *= 1.1; // 10% increase for elevator\n  }\n\n  // Apply safety factor\n  const safetyMultiplier = 1 + params.safetyPct / 100;\n  totalMinutes *= safetyMultiplier;\n\n  // Convert to hours\n  const hours = totalMinutes / 60;\n\n  // Suggest crew size based on cubic feet and complexity\n  let crewSuggestion = 2;\n  if (totalCubicFeet > 1000) crewSuggestion = 4;else if (totalCubicFeet > 500) crewSuggestion = 3;\n\n  // Adjust for stairs/elevator\n  if (params.stairs) crewSuggestion = Math.min(crewSuggestion + 1, 6);\n  if (params.elevator) crewSuggestion = Math.min(crewSuggestion + 1, 6);\n\n  // Calculate total cost\n  const total = hours * params.rate * params.crew;\n  return {\n    hours: Math.round(hours * 10) / 10,\n    // Round to 1 decimal\n    crewSuggestion,\n    total: Math.round(total)\n  };\n}","map":{"version":3,"names":["calculateEstimate","detections","mapping","params","totalMinutes","totalCubicFeet","forEach","detection","mappingItem","label","minutes","qty","cf","travelMins","stairs","elevator","safetyMultiplier","safetyPct","hours","crewSuggestion","Math","min","total","rate","crew","round"],"sources":["/Users/admin/random/src/lib/estimate.ts"],"sourcesContent":["import { Detection, MappingTable, Estimate } from '../types';\n\nexport interface EstimateResult {\n  hours: number;\n  crewSuggestion: number;\n  total: number;\n}\n\nexport function calculateEstimate(\n  detections: Detection[],\n  mapping: MappingTable,\n  params: Omit<Estimate, 'hours' | 'total'>\n): EstimateResult {\n  let totalMinutes = 0;\n  let totalCubicFeet = 0;\n\n  // Calculate total time and cubic feet based on detections\n  detections.forEach(detection => {\n    const mappingItem = mapping[detection.label];\n    if (mappingItem) {\n      totalMinutes += mappingItem.minutes * detection.qty;\n      totalCubicFeet += mappingItem.cf * detection.qty;\n    }\n  });\n\n  // Add travel time\n  totalMinutes += params.travelMins;\n\n  // Apply stairs/elevator multipliers\n  if (params.stairs) {\n    totalMinutes *= 1.3; // 30% increase for stairs\n  }\n  if (params.elevator) {\n    totalMinutes *= 1.1; // 10% increase for elevator\n  }\n\n  // Apply safety factor\n  const safetyMultiplier = 1 + (params.safetyPct / 100);\n  totalMinutes *= safetyMultiplier;\n\n  // Convert to hours\n  const hours = totalMinutes / 60;\n\n  // Suggest crew size based on cubic feet and complexity\n  let crewSuggestion = 2;\n  if (totalCubicFeet > 1000) crewSuggestion = 4;\n  else if (totalCubicFeet > 500) crewSuggestion = 3;\n  \n  // Adjust for stairs/elevator\n  if (params.stairs) crewSuggestion = Math.min(crewSuggestion + 1, 6);\n  if (params.elevator) crewSuggestion = Math.min(crewSuggestion + 1, 6);\n\n  // Calculate total cost\n  const total = hours * params.rate * params.crew;\n\n  return {\n    hours: Math.round(hours * 10) / 10, // Round to 1 decimal\n    crewSuggestion,\n    total: Math.round(total)\n  };\n}\n\n"],"mappings":"AAQA,OAAO,SAASA,iBAAiBA,CAC/BC,UAAuB,EACvBC,OAAqB,EACrBC,MAAyC,EACzB;EAChB,IAAIC,YAAY,GAAG,CAAC;EACpB,IAAIC,cAAc,GAAG,CAAC;;EAEtB;EACAJ,UAAU,CAACK,OAAO,CAACC,SAAS,IAAI;IAC9B,MAAMC,WAAW,GAAGN,OAAO,CAACK,SAAS,CAACE,KAAK,CAAC;IAC5C,IAAID,WAAW,EAAE;MACfJ,YAAY,IAAII,WAAW,CAACE,OAAO,GAAGH,SAAS,CAACI,GAAG;MACnDN,cAAc,IAAIG,WAAW,CAACI,EAAE,GAAGL,SAAS,CAACI,GAAG;IAClD;EACF,CAAC,CAAC;;EAEF;EACAP,YAAY,IAAID,MAAM,CAACU,UAAU;;EAEjC;EACA,IAAIV,MAAM,CAACW,MAAM,EAAE;IACjBV,YAAY,IAAI,GAAG,CAAC,CAAC;EACvB;EACA,IAAID,MAAM,CAACY,QAAQ,EAAE;IACnBX,YAAY,IAAI,GAAG,CAAC,CAAC;EACvB;;EAEA;EACA,MAAMY,gBAAgB,GAAG,CAAC,GAAIb,MAAM,CAACc,SAAS,GAAG,GAAI;EACrDb,YAAY,IAAIY,gBAAgB;;EAEhC;EACA,MAAME,KAAK,GAAGd,YAAY,GAAG,EAAE;;EAE/B;EACA,IAAIe,cAAc,GAAG,CAAC;EACtB,IAAId,cAAc,GAAG,IAAI,EAAEc,cAAc,GAAG,CAAC,CAAC,KACzC,IAAId,cAAc,GAAG,GAAG,EAAEc,cAAc,GAAG,CAAC;;EAEjD;EACA,IAAIhB,MAAM,CAACW,MAAM,EAAEK,cAAc,GAAGC,IAAI,CAACC,GAAG,CAACF,cAAc,GAAG,CAAC,EAAE,CAAC,CAAC;EACnE,IAAIhB,MAAM,CAACY,QAAQ,EAAEI,cAAc,GAAGC,IAAI,CAACC,GAAG,CAACF,cAAc,GAAG,CAAC,EAAE,CAAC,CAAC;;EAErE;EACA,MAAMG,KAAK,GAAGJ,KAAK,GAAGf,MAAM,CAACoB,IAAI,GAAGpB,MAAM,CAACqB,IAAI;EAE/C,OAAO;IACLN,KAAK,EAAEE,IAAI,CAACK,KAAK,CAACP,KAAK,GAAG,EAAE,CAAC,GAAG,EAAE;IAAE;IACpCC,cAAc;IACdG,KAAK,EAAEF,IAAI,CAACK,KAAK,CAACH,KAAK;EACzB,CAAC;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}